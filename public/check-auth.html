<!DOCTYPE html>
<html>
  <head>
    <title>Auth Check</title>
    <style>
      body {
        font-family: system-ui;
        padding: 20px;
        max-width: 800px;
        margin: 0 auto;
      }
      pre {
        background: #f5f5f5;
        padding: 15px;
        border-radius: 5px;
        overflow-x: auto;
      }
      .section {
        margin: 20px 0;
        padding: 15px;
        border: 1px solid #ddd;
        border-radius: 5px;
      }
      h2 {
        color: #333;
        margin-top: 0;
      }
    </style>
  </head>
  <body>
    <h1>Auth Diagnostics</h1>

    <div class="section">
      <h2>LocalStorage</h2>
      <pre id="localStorage"></pre>
    </div>

    <div class="section">
      <h2>Cookies</h2>
      <pre id="cookies"></pre>
    </div>

    <div class="section">
      <h2>API Test (/api/v1/auth/me)</h2>
      <button onclick="testAPI()">Test API</button>
      <pre id="apiResult"></pre>
    </div>

    <script>
      // Display localStorage
      document.getElementById("localStorage").textContent = JSON.stringify(
        {
          token: localStorage.getItem("inventory_auth_token"),
          user: localStorage.getItem("inventory_user"),
        },
        null,
        2
      );

      // Display cookies
      document.getElementById("cookies").textContent =
        document.cookie || "(none)";

      // Test API
      async function testAPI() {
        const resultEl = document.getElementById("apiResult");
        resultEl.textContent = "Testing...";

        try {
          const token = localStorage.getItem("inventory_auth_token");
          const headers = {};
          if (token) {
            headers["Authorization"] = "Bearer " + token;
          }

          const response = await fetch("/api/v1/auth/me", {
            headers,
            credentials: "include",
          });

          const data = await response.json();
          resultEl.textContent = JSON.stringify(
            {
              status: response.status,
              data,
            },
            null,
            2
          );
        } catch (error) {
          resultEl.textContent = "Error: " + error.message;
        }
      }
    </script>
  </body>
</html>
